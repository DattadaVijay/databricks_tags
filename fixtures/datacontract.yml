dataContractSpecification: "0.9.3"
id: bronze-orders-contract
info:
  title: Bronze Orders Contract
  version: 1.0.0

servers:
  dev:
    host: dbc-e3761da8-7d95.cloud.databricks.com
    type: databricks
    catalog: Workspace
    schema: default

models:
  bronze_orders: 
    type: table
    streaming: true
    description: "Raw ingestion table for order events"
    fields:
      event_type:
        type: string
        description: "The stage of the order lifecycle"
        enum: [OrderCreated, OrderCancelled]
      order_id:
        type: string
        description: "The business identifier for the order"
        required: true
      customer_id:
        type: string
        description: "Unique identifier for the customer"
      order_ts:
        type: timestamp
        description: "The UTC timestamp when the event occurred"
      channel:
        type: string
        description: "The source platform of the order"
        enum: [web, mobile]
    
    checks:
      - name: check_not_empty
        description: "Ensures the table is receiving data"
        must: count(*) > 0
      - name: unique_event
        description: "Ensures no duplicate events for the same order ID"
        must: count(*) = count(distinct order_id, event_type)